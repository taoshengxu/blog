<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Shiny and Shiny server学习 - My Lives</title>
    <meta property="og:title" content="Shiny and Shiny server学习 - My Lives">
    

    
      
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/blog/css/style.css" />
    <link rel="stylesheet" href="/blog/css/fonts.css" />
    <link rel="stylesheet" href="/blog/css/custom.css" />

  </head>

  
  <body class="blog">
    <header class="masthead">
      <h1><a href="/blog/">My Lives</a></h1>



      <nav class="menu">
        <input id="menu-check" type="checkbox" />
        <label id="menu-label" for="menu-check" class="unselectable">
          <span class="icon close-icon">✕</span>
          <span class="icon open-icon">☰</span>
          <span class="text">Menu</span>
        </label>
        <ul>
        
        
        <li><a href="/blog/">Home</a></li>
        
        <li><a href="/blog/en/">English</a></li>
        
        <li><a href="/blog/cn/">Chinese</a></li>
        
        <li><a href="/blog/paper/">Paper Reading</a></li>
        
        <li><a href="/blog/travel/">Travel</a></li>
        
        
        </ul>
      </nav>
    </header>

    <article class="main">
      <header class="title">
      
<h1>Shiny and Shiny server学习</h1>

<h3>
  2017-09-05</h3>
<hr>


      </header>





<p>Rblogdonw+Hugo用来实现静态网页，Shiny用于实现动态网页，几乎把R这个工具发挥到了极致，使其无所不能，R可以解决一切<strong>简单</strong>的需要了。</p>

<hr />

<h1 id="1-shiny">1. Shiny</h1>

<ul>
<li><a href="http://yanping.me/shiny-tutorial/">中文教程</a>. Among them, the Articles are very useful.</li>
<li><a href="https://shiny.rstudio.com/tutorial/">英文教程</a></li>
<li><a href="https://github.com/rstudio/shiny-examples">Examples</a></li>
<li><a href="https://taoshengxu.github.io/DocumentGit/pdf/shiny-cheatsheet.pdf">shiny-cheatsheet</a>
然而shiny太素颜了，需要一些扩展使得其表现美妙起来。<br /></li>
</ul>

<h1 id="2-shiny-with-html">2. Shiny with HTML</h1>

<pre><code class="language-r">names(shiny::tages)  ## 100多种HTML标签

tags$div(class = &quot;header&quot;, checked = NA,
  tags$p(&quot;Ready to take the Shiny tutorial? If so&quot;),
  tags$a(href = &quot;shiny.rstudio.com/tutorial&quot;, &quot;Click Here!&quot;)
)
## &lt;div class=&quot;header&quot; checked&gt;
##   &lt;p&gt;Ready to take the Shiny tutorial? If so&lt;/p&gt;
##   &lt;a href=&quot;shiny.rstudio.com/tutorial&quot;&gt;Click Here!&lt;/a&gt;
## &lt;/div&gt; 

withTags({
  div(class=&quot;header&quot;, checked=NA,
    p(&quot;Ready to take the Shiny tutorial? If so&quot;),
    a(href=&quot;shiny.rstudio.com/tutorial&quot;, &quot;Click Here!&quot;)
  )
})
## &lt;div class=&quot;header&quot; checked&gt;
##   &lt;p&gt;Ready to take the Shiny tutorial? If so&lt;/p&gt;
##   &lt;a href=&quot;shiny.rstudio.com/tutorial&quot;&gt;Click Here!&lt;/a&gt;
## &lt;/div&gt; 

##lists
tags$div(class=&quot;header&quot;, checked=NA,
  list(
    tags$p(&quot;Ready to take the Shiny tutorial? If so&quot;),
    tags$a(href=&quot;shiny.rstudio.com/tutorial&quot;, &quot;Click Here!&quot;),
    &quot;Thank you&quot;
  )
)
## &lt;div class=&quot;header&quot; checked&gt;
##   &lt;p&gt;Ready to take the Shiny tutorial? If so&lt;/p&gt;
##   &lt;a href=&quot;shiny.rstudio.com/tutorial&quot;&gt;Click Here!&lt;/a&gt;
##   Thank you
## &lt;/div&gt; 


# Raw HTML 加 HTML()
tags$div(
  HTML(&quot;&lt;strong&gt;Raw HTML!&lt;/strong&gt;&quot;)
)
## &lt;div&gt;&lt;strong&gt;Raw HTML!&lt;/strong&gt;&lt;/div&gt; 
</code></pre>

<pre><code class="language-r">  tags$head(
    tags$style(type='text/css', 
               &quot;select, textarea, input[type='text'] {margin-bottom: 0px;}&quot;
               , &quot;#submit {
               color: rgb(255, 255, 255);
               text-shadow: 0px -1px 0px rgba(0, 0, 0, 0.25);
               background-color: rgb(189,54,47);
               background-image: -moz-linear-gradient(center top , rgb(238,95,91), rgb(189,54,47));
               background-repeat: repeat-x;
               border-color: rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.25);
               }&quot;
    ),
    tags$script(HTML('
                     Shiny.addCustomMessageHandler(&quot;jsCode&quot;,
                     function(message) {
                     eval(message.value);
                     }
                     );'
    ))
    )
</code></pre>

<p>HTML 前端+ Shiny服务器端数据响应机制</p>

<ul>
<li><p>HTML form elements (in this case a select list and a number input) are bound to input slots using their <strong>name</strong> attribute.</p></li>

<li><p>Output is rendered into HTML elements based on matching their <strong>id</strong> attribute to an output slot and by specifying the requisite css class for the element (in this case either shiny-text-output, shiny-plot-output, or shiny-html-output)</p></li>
</ul>

<pre><code>library(shiny)
runExample(&quot;08_html&quot;)
</code></pre>

<h1 id="3-shiny-server">3. shiny server</h1>

<p><a href="https://github.com/rstudio/shiny-server">学习入口</a><br />
<a href="https://www.rstudio.com/products/shiny/download-server/">最新安装文件</a></p>

<pre><code class="language-r">$ sudo su - \
-c &quot;R -e \&quot;install.packages('shiny', repos='https://cran.rstudio.com/')\&quot;&quot;
$ sudo apt-get install gdebi-core
$ wget https://download3.rstudio.org/ubuntu-12.04/x86_64/shiny-server-1.5.4.869-amd64.deb
$ sudo gdebi shiny-server-1.5.4.869-amd64.deb

start shiny-server 　　　　   # 启动
stop shiny-server 　　　　　# 停止
restart shiny-server 　　　　# 重启
status shiny-server 　　　　#查看状态  
reload shiny-server 　　　　#不中断服务的前提下 更新加载配置项
</code></pre>

<h3 id="web-查看">web 查看</h3>

<p>默认端口时3838</p>

<pre><code>localhost:3838   
</code></pre>

<p><strong>可以在配置文件(/etc/shiny-server/shiny-server.conf)中修改</strong></p>

<ul>
<li><p>端口</p></li>

<li><p>run_as默认为shiny,可改为username</p></li>
</ul>

<p><strong>开发的apps拷贝到目录(/srv/shiny-server/)下</strong></p>

<pre><code>sudo cp ~/app file /srv/shiny-server/ 将文件拷入
</code></pre>

<h3 id="日志文件">日志文件</h3>

<p>日志文件在(/var/log/shiny-server/)目录下查看</p>

<h2 id="一个生信技能树的安装参考教程">一个生信技能树的安装参考教程</h2>

<pre><code class="language-r">######
前几天刚好在亚马逊云上注册了一个1年免费的Amazon Web Services (AWS) ，
正好以此来尝试学习下shiny的相关东西。

主要参考了：
http://deanattali.com/2015/05/09/setup-rstudio-shiny-server-digital-ocean/
http://www.bio-info-trainee.com/1683.html
操作系统：ubuntu
1. 安装 R
        sudo apt install r-base
2. 安装Rstudio-server
        sudo apt-get install gdebi-core
        sudo apt-get install libapparmor1
        wget https://download2.rstudio.org/rstudio-server-1.0.143-amd64.deb
        sudo gdebi rstudio-server-1.0.143-amd64.deb
因为Rstudio-server不能以root用户登录，所以我们需要创建一个用户
        sudo adduser xxxxx
        ......
然后在网页上输入ip:8787进入Rstudio-server界面，输入用户和密码，即可登录

3. 安装Shiny
        sudo su - -c &quot;R -e \&quot;install.packages('shiny', repos='http://cran.rstudio.com/')\&quot;&quot;

(我注：**如果将配置文件run_as 改为username就不用考虑这个问题，
所以安装完shiny server之后就修改run_as为当前的用户，
不然后面开发中许多包都找不到**)

不能直接进入R，然后install.packages(&quot;shiny&quot;)，因为如果这样安装，
是将shiny包安装下当前登录用户的个人library中，使得最终shiny-server无法运行。

        apt-get install gdebi-core
        wget https://download3.rstudio.org/ub ... 1.5.3.838-amd64.deb
        sudo gdebi shiny-server-1.5.3.838-amd64.deb

做完以上几步后，shiny-server算是初步安装好了，然后可以在网页上ip:3838
进入shiny-server界面(ip是你服务器的ip地址)。
一般我们能看到左边一列的文字和右边的两个框。
当然还需要再安装个rmarkdown，不然还是会有error的

        sudo su - -c &quot;R -e \&quot;install.packages('rmarkdown', repos='http://cran.rstudio.com/')\&quot;&quot;

4. 配置shiny server

    * Shiny Server log is at /var/log/shiny-server.log
    * The default Shiny Server homepage you’re seeing is located at /srv/shiny-server/index.html
- you can edit it or remove it.
    * Any Shiny app directory that you place under /srv/shiny-server/ will be served as a Shiny app. For example, there is a default app at /srv/shiny-server/sample-apps/hello/, which means you can run the app by going to http://123.456.1.2:3838/sample-apps/hello/

    * The config file for Shiny Server is at /etc/shiny-server/shiny-server.conf
    * To reload the server after editing the config, use sudo reload shiny-server
    * When hosting an Rmarkdown file, name the file index.rmd and add runtime: shiny to the document’s frontmatter

5. 赋予shiny权限
假设当你登录是以自己用户登录，你在shiny server创建的文件只有该用户（除了root）才有权限读写，但是shiny server是以shiny用户来运行shiny的app，所以要给予shiny用户在一些目录的权限。
例如：

        sudo groupadd shiny-apps
        sudo usermod -aG shiny-apps dean
        sudo usermod -aG shiny-apps shiny
        sudo chown -R dean:shiny-apps /srv/shiny-server
        sudo chmod g+w /srv/shiny-server
        sudo chmod g+s /srv/shiny-server  ####在该目录下创建的文件都属于该目录所属的组
        
6. 下载shiny官网的例子
git clone https://github.com/rstudio/shiny-examples.git
文件是要下载到/srv/shiny-server中
7. 运行例子程序
http://ip:3838/shiny-examples/010-download/ （ip是你服务器的ip地址）
想要运行哪个shiny app，只要在ip:3838/后面添加/srv/shiny-server中的文件的相对路径即可
###
</code></pre>

<h1 id="4-shinydashboard">4. Shinydashboard</h1>

<p>这是一个扩展R包，使其有一些面板功能。入门讲解在<a href="https://rstudio.github.io/shinydashboard/index.html">这里</a></p>

<h1 id="5-shinyjs">5. Shinyjs</h1>

<p>从<a href="https://github.com/daattali/shinyjs">这里学习</a>，这个放在以后再深入吧。</p>

<h1 id="6-shinythemes">6. Shinythemes</h1>

<hr />

<p>最近用shiny做了一个页面，也是一个艰难的开始。Mark in(&ldquo;Mon Sep 04 19:03:13 2017&rdquo;)</p>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">&larr; <a href="/blog/cn/2017/08/a-collection-of-command/">DOS-Ubuntu命令集合</a></span>
  <span class="nav-next"><a href="/blog/cn/2017/09/ubuntu_r/">Ubuntu 安装R, RStudio, Rstudio Server, JAVA</a> &rarr;</span>
</nav>





<script src="//yihui.name/js/math-code.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.name/js/center-img.js"></script>

  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">&copy; <a href="xxxx">Who care</a> 2017 - Forever, maybe</div>
  
  </footer>
  </article>
  
  </body>
</html>

