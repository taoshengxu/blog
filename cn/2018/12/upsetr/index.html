<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>UpSetR包 - My Lives</title>
    <meta property="og:title" content="UpSetR包 - My Lives">
    

    
      
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/blog/css/style.css" />
    <link rel="stylesheet" href="/blog/css/fonts.css" />
    <link rel="stylesheet" href="/blog/css/custom.css" />

  </head>

  
  <body class="blog">
    <header class="masthead">
      <h1><a href="/blog/">My Lives</a></h1>



      <nav class="menu">
        <input id="menu-check" type="checkbox" />
        <label id="menu-label" for="menu-check" class="unselectable">
          <span class="icon close-icon">✕</span>
          <span class="icon open-icon">☰</span>
          <span class="text">Menu</span>
        </label>
        <ul>
        
        
        <li><a href="/blog/">Home</a></li>
        
        <li><a href="/blog/en/">English</a></li>
        
        <li><a href="/blog/cn/">Chinese</a></li>
        
        <li><a href="/blog/paper/">Paper Reading</a></li>
        
        <li><a href="/blog/travel/">Travel</a></li>
        
        
        </ul>
      </nav>
    </header>

    <article class="main">
      <header class="title">
      
<h1>UpSetR包</h1>

<h3>
  2018-12-24</h3>
<hr>


      </header>





<p><a href="https://www.jianshu.com/p/324aae3d5ea4">https://www.jianshu.com/p/324aae3d5ea4</a></p>

<pre><code class="language-R">install.packages(UpSetR)
</code></pre>

<h5 id="输入方式一-table">输入方式一： table</h5>

<pre><code class="language-R">require(ggplot2); require(plyr); require(gridExtra); require(grid);
movies &lt;- read.csv(system.file(&quot;extdata&quot;,&quot;movies.csv&quot;,package = &quot;UpSetR&quot;), header = TRUE, sep=&quot;;&quot;)
View(movies)
upset(movies, nsets = 7, nintersects = 30, mb.ratio = c(0.5, 0.5),
      order.by = c(&quot;freq&quot;, &quot;degree&quot;), decreasing = c(TRUE,FALSE))
#nsets: 最多展示多少个集合数据。毕竟原来有20多种电影类型，放不完的
#nintersects: 展示多少交集。
#mb.ratio： 点点图和条形图的比例。
#order.by： 交集如何排序。这里先根据freq，然后根据degree
#decreasing： 变量如何排序。这里表示freq降序，degree升序
# 用于query的函数
between &lt;- function(row, min, max){
  newData &lt;- (row[&quot;ReleaseDate&quot;] &lt; max) &amp; (row[&quot;ReleaseDate&quot;] &gt; min)
}

upset(movies, sets=c(&quot;Drama&quot;,&quot;Comedy&quot;,&quot;Action&quot;,&quot;Thriller&quot;,&quot;Western&quot;,&quot;Documentary&quot;),
      queries = list(list(query = intersects, params = list(&quot;Drama&quot;, &quot;Thriller&quot;)),
                     list(query = between, params=list(1970,1980), color=&quot;red&quot;, active=TRUE)))
#queries接受query所组成的list。然后不同query也是一个list，这个list由查询函数，和参数组成，参数也是一个list。查询函数可以用系统自带的，也可以自己写一个。比如说这里的between

upset(movies,attribute.plots=list(gridrows=60,plots=list(list(plot=scatter_plot, x=&quot;ReleaseDate&quot;, y=&quot;AvgRating&quot;),
                                                         list(plot=scatter_plot, x=&quot;ReleaseDate&quot;, y=&quot;Watches&quot;),list(plot=scatter_plot, x=&quot;Watches&quot;, y=&quot;AvgRating&quot;),
                                                         list(plot=histogram, x=&quot;ReleaseDate&quot;)), ncols = 2))
</code></pre>

<h3 id="输入方式二-集合交集向量">输入方式二：集合交集向量</h3>

<pre><code class="language-R">input &lt;- c(
  &quot;MAQ&quot;=144600,
  &quot;FaSD&quot;=16532, 
  &quot;Bcftools&quot;=283, 
  &quot;GATK&quot;=15160, 
  &quot;MAQ&amp;FaSD&quot;=16323, 
  &quot;MAQ&amp;Bcftools&quot;=636, 
  &quot;Bcftools&amp;GATK&quot;=65435, 
  &quot;FaSD&amp;GATK&quot;=33874, 
  &quot;MAQ&amp;FaSD&amp;Bcftools&quot;=114, 
  &quot;MAQ&amp;FaSD&amp;GATK&quot;=41858, 
  &quot;MAQ&amp;Bcftools&amp;GATK&quot;=4, 
  &quot;FaSD&amp;Bcftools&amp;GATK&quot;=6603, 
  &quot;MAQ&amp;FaSD&amp;Bcftools&amp;GATK&quot;=8357
)
data &lt;- fromExperssion(input)
upset(data)
</code></pre>

<h3 id="upsetplot">upsetplot()</h3>

<pre><code>require(TxDb.Hsapiens.UCSC.hg19.knownGene)
txdb &lt;- TxDb.Hsapiens.UCSC.hg19.knownGene
peakfile &lt;- system.file(&quot;extdata&quot;, &quot;sample_peaks.txt&quot;, package=&quot;ChIPseeker&quot;)
peakAnno &lt;- annotatePeak(peakfile, tssRegion=c(-3000, 3000), TxDb=txdb)
peakAnno
upsetplot(peakAnno, vennpie=TRUE)
</code></pre>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">&larr; <a href="/blog/cn/2018/12/win10_linux/">Win10 Linux子系统</a></span>
  <span class="nav-next"></span>
</nav>





<script src="//yihui.name/js/math-code.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.name/js/center-img.js"></script>

  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">&copy; <a href="xxxx">Who care</a> 2017 - Forever, maybe</div>
  
  </footer>
  </article>
  
  </body>
</html>

