<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>dplyr包_tidyr包 - My Lives</title>
    <meta property="og:title" content="dplyr包_tidyr包 - My Lives">
    

    
      
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/blog/css/style.css" />
    <link rel="stylesheet" href="/blog/css/fonts.css" />
    <link rel="stylesheet" href="/blog/css/custom.css" />

  </head>

  
  <body class="blog">
    <header class="masthead">
      <h1><a href="/blog/">My Lives</a></h1>



      <nav class="menu">
        <input id="menu-check" type="checkbox" />
        <label id="menu-label" for="menu-check" class="unselectable">
          <span class="icon close-icon">✕</span>
          <span class="icon open-icon">☰</span>
          <span class="text">Menu</span>
        </label>
        <ul>
        
        
        <li><a href="/blog/">Home</a></li>
        
        <li><a href="/blog/en/">English</a></li>
        
        <li><a href="/blog/cn/">Chinese</a></li>
        
        <li><a href="/blog/paper/">Paper Reading</a></li>
        
        <li><a href="/blog/travel/">Travel</a></li>
        
        
        </ul>
      </nav>
    </header>

    <article class="main">
      <header class="title">
      
<h1>dplyr包_tidyr包</h1>

<h3>
  2018-12-23</h3>
<hr>


      </header>





<p><a href="https://blog.csdn.net/pilouduo1367/article/details/69675678">https://blog.csdn.net/pilouduo1367/article/details/69675678</a></p>

<h1 id="1-dplyr包-数据框整理神器">1 dplyr包&ndash;数据框整理神器</h1>

<h3 id="1-1-展现数据-tbl-df">1.1 展现数据 <code>tbl_df()</code>：</h3>

<p>函数<code>tbl_df()</code>使得大数据集规范显示出来，行列都只显示10个，跟head差不多，但是head只能控制行，无法控制列，使用<code>tbl_df()</code>就是为了防止数据刷屏。</p>

<h3 id="1-2-筛选数据-filter">1.2 筛选数据 <code>filter()</code>：</h3>

<p>按给定的逻辑判断筛选出符合要求的子数据集</p>

<pre><code class="language-R">mtcars_df &lt;- tbl_df(mtcars)
filter(mtcars_df, mpg == 21, cyl == 6)
# A tibble: 2 × 11
#    mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
#  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#1    21     6   160   110   3.9 2.620 16.46     0     1     4     4
#2    21     6   160   110   3.9 2.875 17.02     0     1     4     4
</code></pre>

<h3 id="1-3-排列数据-arrange">1.3 排列数据 <code>arrange()</code>：</h3>

<pre><code class="language-R">#先对cyl列正序排列，再对carb列倒序排列
xx= arrange(mtcars_df, cyl, desc(carb))
</code></pre>

<h3 id="1-4-选择子集-select">1.4 选择子集 <code>select()</code></h3>

<p>用列名作参数来选择子数据集</p>

<pre><code class="language-R">select(mtcars_df, mpg, disp:wt, carb) # disp:wt表示从disp列选到wt列
</code></pre>

<h3 id="1-5-变形-mutate">1.5 变形 <code>mutate()</code>：</h3>

<p>对已有列进行数据运算并添加为新列</p>

<pre><code class="language-R">mutate(mtcars_df, NO = 1:dim(mtcars_df)[1], res = hp - drat)  
</code></pre>

<h3 id="1-6-总览数据-summarise">1.6 总览数据 <code>summarise()</code>：</h3>

<p>对数据框调用其它函数进行汇总操作, 返回一维的结果</p>

<pre><code class="language-R">summarise(mtcars_df, mdisp = mean(disp, na.rm = TRUE), mhp = mean(hp, na.rm = TRUE))
# A tibble: 1 × 2
     mdisp      mhp
     &lt;dbl&gt;    &lt;dbl&gt;
1 230.7219 146.6875
</code></pre>

<h3 id="1-7-数据分组-group-by">1.7 数据分组 <code>group_by()</code>：</h3>

<p>当对数据集通过group_by()添加了分组信息后，mutate()，arrange() 和 summarise() 函数会自动对这些 tbl 类数据执行分组操作。</p>

<pre><code class="language-R">cars &lt;- group_by(mtcars_df, cyl)
(countcars &lt;- summarise(cars, count = n())) # count = n()用来计算次数
# A tibble: 3 × 2
    cyl count
  &lt;dbl&gt; &lt;int&gt;
1     4    11
2     6     7
3     8    14
</code></pre>

<h1 id="2-tidyr包-数据变形">2 tidyr包&ndash;数据变形</h1>

<h3 id="2-1-宽转长-gather">2.1 宽转长 <code>gather()</code>：</h3>

<p>使用gather()函数实现宽表转长表，语法如下：</p>

<pre><code class="language-R"># gather(data, key, value, …, na.rm = FALSE, convert = FALSE)
# data：需要被转换的宽形表
# key：将原数据框中的所有列赋给一个新变量key
# value：将原数据框中的所有值赋给一个新变量value
# …：可以指定哪些列聚到同一列中
# na.rm：是否删除缺失值

longdata &lt;- gather(mtcars_df, attribute, value, -mpg)
longdata &lt;- gather(mtcars_df, attribute, value)
longdata &lt;- gather(mtcars_df, attribute, value, mpg, carb)
</code></pre>

<h3 id="2-2-长转宽-spread">2.2 长转宽 <code>spread()</code>：</h3>

<p>有时，为了满足建模或绘图的要求，往往需要将长形表转换为宽形表，或将宽形表变为长形表。如何实现这两种数据表类型的转换。使用spread()函数实现长表转宽表，语法如下：</p>

<pre><code># spread(data, key, value, fill = NA, convert = FALSE, drop = TRUE)
# data：为需要转换的长形表
# key：需要将变量值拓展为字段的变量
# value：需要分散的值
# fill：对于缺失值，可将fill的值赋值给被转型后的缺失值

spread(longdata, attribute, value)
</code></pre>

<h3 id="2-3-合并-unit">2.3 合并 <code>unit()</code>：</h3>

<pre><code class="language-R"># unite(data, col, …, sep = “_”, remove = TRUE)
# data：为数据框
# col：被组合的新列名称
# …：指定哪些列需要被组合
# sep：组合列之间的连接符，默认为下划线
# remove：是否删除被组合的列

TIMES &lt;- data.frame(years = c('1990', '1991', '1992'), months = c(2,3,4), day = c(1, 2, 3))
TIMESunite &lt;- unite(TIMES, information, months, day, sep= &quot;-&quot;)
</code></pre>

<h3 id="2-4-拆分-separate">2.4 拆分 <code>separate()</code>：</h3>

<p>separate()函数可将一列拆分为多列，一般可用于日志数据或日期时间型数据的拆分.</p>

<pre><code class="language-R"># separate(data, col, into, sep = “[^[:alnum:]]+”, remove = TRUE,
# convert = FALSE, extra = “warn”, fill = “warn”, …)
# data：为数据框
# col：需要被拆分的列
# into：新建的列名，为字符串向量
# sep：被拆分列的分隔符
# remove：是否删除被分割的列
TIMESsep &lt;- separate(TIMESunite, information, c(&quot;months&quot;, &quot;day&quot;), sep = &quot;-&quot;)
</code></pre>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">&larr; <a href="/blog/cn/2018/12/wgcna/">WGCNA加权基因共表达网络分析</a></span>
  <span class="nav-next"></span>
</nav>





<script src="//yihui.name/js/math-code.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.name/js/center-img.js"></script>

  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">&copy; <a href="xxxx">Who care</a> 2017 - Forever, maybe</div>
  
  </footer>
  </article>
  
  </body>
</html>

